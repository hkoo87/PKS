# PKS
The PKS is newly added analysis followed by mgSNP_2 (https://github.com/hkoo87/mgSNP_2). It is now possible to analyze for microbial strain variation based on comparing the patterns of presence/absence of KEGG metabolic pathways for a selected strain (PKS). \
Version = 1.0 \
Date = March 4, 2021 \
DOI = 10.5281/zenodo.4923729 

Provided scripts were written to work on SLURM cluster, thus included SLURM specific code for job submission.

Requirements
------------
1. Samtools
2. BEDTools
3. MEGAHIT
4. Prokka
5. MinPath

Installation
------------
Download all provided scripts, then follow the commands below. \
PKS analysis is followed by the mgSNP_2 analysis. 

Stepwise analysis
------------
1. The first script of PKS analysis can be used after Steps 1-6 are completed which were written in the Stepwise analysis of mgSNP_2. Once the GATK_STEPS folder is generated by the mgSNP_2, the below script can be run. If the species name needs to be changed, modify the species name in the script. This script will include only selected species' alignments from each sample's realigned.bam file.

>sbatch PKS_bamtofastq.sh

Output: Creates a folder MEGAHIT-Bvul. Inside that, ${SAMPLE}.fastq files are generated.

2. The converted FASTQ file of each sample will be assembled by running the below script. 

>sbatch PKS_megahit_run.sh

Output: final.contigs.fa file is generated for each sample.

3. The resultant final.contigs.fa file for each sample is then annotated using Prokka, 'eC_number' is grepped from the '.gff' file, and then each 'eC_number' is annotated against the KEGG database using MinPath. The resultant 'map ID' is selected based on the minpath value 1. These steps can be conducted executing the below script. 

>sbatch PKS_Prokka_Minpath.sh

Output: *.kegg.reportLabel.minpath1 file includes annotated information for each sample. 






